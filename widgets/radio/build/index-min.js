/*! radio 2013-11-28 02:14:16 */
KISSY.add("radio/index",function(a,b){function c(){this.initRadio.apply(this,arguments)}c.ATTRS={value:{value:""},text:{value:""},index:{value:-1},list:{setter:function(a){return a&&$(a)}},items:{value:""},checkedItem:{value:null},checked:{value:0},listTemplate:{value:"<ul></ul>"},itemTemplate:{value:'<li data-value="{value}" data-text="{text}"><span>{text}</span><b></b></li>'}},a.augment(c,{initRadio:function(){this.radioRendered=!1},destroyRadio:function(){this.items&&(this.items.off(),this.items.remove())},renderRadio:function(){return this._createList(),this._createItems(),this},bindRadio:function(){var a=($.os.phone||$.os.tablet,"click");return this.items.on(a,$.proxy(this._onRadioItemClick,this)),this.radioRendered?this:(this.on("afterItemsChange",this._afterRadioItemsChange),this.on("afterCheckedItemChange",this._afterCheckedItemChange),this)},syncRadio:function(a){var b=this.get("checked");return"undefined"!=typeof a?this.select(a):"undefined"!=typeof b&&this.select(b),this},refresh:function(a){return this.renderRadio(),this.bindRadio(),this.syncRadio(a),this.radioRendered=!0,this},select:function(a,b){return"number"==typeof a?(a=a>-1?this.items.eq(a):null,a=a&&a[0]||null):"string"==typeof a?a=this.getItemByVal(a):a&&"function"==typeof a.find&&(a=a[0]),this.set("checkedItem",a,{silent:b}),this},getItemByVal:function(a){var b=null;return $.each(this.items,function(c,d){return $(d).attr("data-value")==a?(b=d,!1):void 0}),b},_createList:function(){this.list=this.get("list"),this.list||(this.list=$(this.get("listTemplate")),this.set("list",this.list,{silent:!0})),this.list.addClass("m-radio-list")},_createItems:function(){var b=this.get("items"),c=this.get("itemTemplate"),d="";this.items&&this.items.off().remove(),"string"==typeof b?this.items=this.list.find(b):a.isArray(b)?($.each(b,function(b,e){d+=a.substitute(c,e)}),this.items=$(d),this.list.append(this.items)):this.items=$(b),this.set("items",this.items,{silent:!0}),this.items.addClass("m-radio-item")},_afterRadioItemsChange:function(){this.refresh()},_afterCheckedItemChange:function(a){var b=$(a.newVal),c=$(a.prevVal),d=a.newVal?b.attr("data-value"):"",e=a.newVal?b.attr("data-text"):"",f=a.newVal?this.items.indexOf(a.newVal):-1;this.set("value",d),this.set("text",e),this.set("index",f),b.addClass("m-radio-checked"),c.removeClass("m-radio-checked"),this.fire("select",{node:b,item:a.newVal,value:d,text:e,index:f})},_onRadioItemClick:function(a){this.set("checkedItem",a.currentTarget)}});var d=b.extend([c],{render:function(a){return this.refresh(),a=a&&$(a),a&&a[0]&&a.append(this.list),this},destructor:function(){this.destroyRadio.apply(this,arguments)}});return d.Ext=c,d},{requires:["base"]});